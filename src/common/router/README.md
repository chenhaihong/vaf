# beforeEach 鉴权逻辑

```
==================================================================================
路由拦截逻辑 - 方式1 (不采用)
==================================================================================
1 这个路由可以匿名访问
  1.1 用户未登录       next()
  1.2 用户已经登录
      2.1.1 登录页     next('/')
      2.1.2 其他页面   next()
2 需登录才能访问
  2.1 用户未登录
      2.1.1 登录页     next()
      2.1.2 其他页面   next(`/login?redirect=${fromHash}`)
  2.2 用户已经登录
      2.2.1 登录页     next('/')
      2.2.2 其他页面
            2.2.2.1 拉取信息失败   next('/500')，在request中处理错误提示
            2.2.2.2 拉取信息成功   next()
3 需鉴别权限后才能访问
  3.1 用户未登录
      3.1.1 登录页     next()
      3.1.2 其他页面   next(`/login?redirect=${fromHash}`)
  3.2 用户已经登录
      3.2.1 登录页     next('/')
      3.2.2 未拉取用户信息
           3.2.2.1 拉取信息失败   next('/500')，在request中处理错误提示
           3.2.2.2 拉取信息成功   更新本地信息，走分支3.2.3
      3.2.3 拉取成功
           3.2.3.1 有访问权限   next()
           3.2.3.2 无访问权限 next('/403')
==================================================================================
路由拦截逻辑 - 方式2 (采用方式2)
==================================================================================
1 未登录
  1.1 登录页                               next()
  1.2 这个路由可以匿名访问                   next()
  1.3 需登录才能访问 || 需鉴别权限后才能访问   next('/login?redirect=${fromHash}')
  1.4 其他情况                               next('/403')
2 已经登录
  2.1 登录页                               next('/')
  2.2 这个路由可以匿名访问                   next()
  2.3 需登录才能访问 || 需鉴别权限后才能访问
      2.3.1 未拉取用户信息
           2.3.1.1 拉取信息失败   next('/500')，在request中处理错误提示
           2.3.1.2 拉取信息成功   更新本地信息，走分支2.3.2
      2.3.2 已拉取用户信息
            2.3.2.1 登录可访问 || 有访问权限  next()
            2.3.2.2 无访问权限               next('/403')
  2.4 其他情况                               next('/403')
==================================================================================
```
